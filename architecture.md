# ポモドーロタイマーWebアプリ アーキテクチャ案

## 1. ディレクトリ構成案

```
1.pomodoro/
  app.py                # Flaskアプリ本体
  templates/
    index.html          # メイン画面テンプレート
  static/
    css/
      style.css         # スタイルシート
    js/
      timer.js          # タイマー制御用JS
  tests/                # ユニットテスト用ディレクトリ
    test_app.py         # Flask用テスト
    js/
      timer.test.js     # JS用テスト
```

## 2. アーキテクチャ概要

### バックエンド（Flask）
- ルーティングは主に1つ（例: `/`）で、index.htmlを返す。
- 必要に応じて履歴保存や設定管理のAPIエンドポイントを追加。
- タイマーのカウントはクライアント側（JS）で行い、履歴や設定保存のみFlask経由でDBやファイルに保存。
- ビジネスロジックとルーティングを分離し、テストしやすい構成にする。
- テスト用設定（例: テスト用DBやモックデータ）をFlaskのconfigで切り替え可能にする。

### フロントエンド（HTML/CSS/JS）
- UIはindex.htmlで構築し、モック画像のデザインを再現。
- タイマーのカウントダウンや状態管理（ポモドーロ/休憩の切替）はtimer.jsで実装。
- タイマー制御ロジックは関数やクラスとして分離し、UI操作とロジックを分ける。
- ボタン操作（開始/停止/リセット/スキップ等）はJSでイベントハンドリング。
- 必要に応じてAJAXで履歴保存や取得をFlask APIにリクエスト。
- DOM操作やサーバー通信はラップし、テスト時にはモック化できるようにする。

### スタイル（CSS）
- モック画像に合わせてstyle.cssでデザインを調整。
- レスポンシブ対応も考慮。

## 3. ユニットテスト容易化のための工夫
- バックエンドのロジックは関数やクラスとして分離し、個別にテスト可能にする。
- RESTfulなAPI設計で、API単位でのテストを容易にする。
- テストディレクトリ（tests/）を設置し、各層ごとにテストファイルを分離。
- 依存注入を活用し、DBや外部サービスへの依存をテスト時にモックやスタブに差し替え可能にする。
- フロントエンドのロジックも関数化・クラス化し、Jest等で単体テストしやすくする。
- CI/CD（例: GitHub Actions）で自動テストを実行し、品質を担保する。

## 4. 拡張性・保守性のポイント
- タイマーの状態は基本的にクライアント側で管理し、サーバーは履歴や設定保存などに特化。
- 機能追加（例: 設定画面、履歴グラフ表示など）はAPIエンドポイントやテンプレートを追加して拡張。
- テストやデバッグのしやすさを考え、ロジックはJS/Flaskともに関数分割。

---

このアーキテクチャにより、シンプルかつ拡張性・テスト容易性の高いWebアプリ開発が可能です。